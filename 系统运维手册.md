# OCR PNG to Excel - ç³»ç»Ÿè¿ç»´æ‰‹å†Œ

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2026-01-16  
**ç›®æ ‡è¯»è€…**: ç³»ç»Ÿç®¡ç†å‘˜ã€è¿ç»´å·¥ç¨‹å¸ˆ

---

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [æœåŠ¡ç®¡ç†](#æœåŠ¡ç®¡ç†)
- [æ—¥å¸¸è¿ç»´](#æ—¥å¸¸è¿ç»´)
- [ç›‘æ§å‘Šè­¦](#ç›‘æ§å‘Šè­¦)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [å¤‡ä»½æ¢å¤](#å¤‡ä»½æ¢å¤)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·æµè§ˆå™¨                      â”‚
â”‚              http://æœåŠ¡å™¨IP:3000                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å‰ç«¯æœåŠ¡ (React)                     â”‚
â”‚                ç«¯å£: 3000                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTP API
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            åç«¯æœåŠ¡ (FastAPI)                     â”‚
â”‚                ç«¯å£: 8000                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ä¸Šä¼     â”‚   OCR    â”‚  Excel   â”‚  è¡¨æ ¼    â”‚ â”‚
â”‚  â”‚  æ¨¡å—    â”‚  æ¨¡å—    â”‚  æ¨¡å—    â”‚  æ¨¡å—    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚
         â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQLite æ•°æ®åº“  â”‚  â”‚  OCR æœåŠ¡       â”‚
â”‚                 â”‚  â”‚  ç«¯å£: 8088     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ–‡ä»¶å­˜å‚¨ (data/)                     â”‚
â”‚  â”œâ”€ images/      - ä¸Šä¼ çš„å›¾ç‰‡                    â”‚
â”‚  â”œâ”€ ocr_json/    - OCR ç»“æœ JSON                â”‚
â”‚  â”œâ”€ excel/       - ç”Ÿæˆçš„ Excel æ–‡ä»¶             â”‚
â”‚  â””â”€ edited/      - ç¼–è¾‘åçš„æ•°æ®                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœåŠ¡ç«¯å£

| æœåŠ¡ | ç«¯å£ | åè®® | ä½œç”¨ |
|------|------|------|------|
| å‰ç«¯ | 3000 | HTTP | Web ç•Œé¢ |
| åç«¯ | 8000 | HTTP | REST API |
| OCR | 8088 | HTTP | è¡¨æ ¼è¯†åˆ« |

### ç›®å½•ç»“æ„

```
/home/lenovo/development_project/ocrpngtoexcel_test/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/            # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ clients/        # å¤–éƒ¨å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ main.py             # åº”ç”¨å…¥å£
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚   â”‚   â””â”€â”€ services/      # API æœåŠ¡
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ images/            # ä¸Šä¼ å›¾ç‰‡
â”‚   â”œâ”€â”€ ocr_json/          # OCR ç»“æœ
â”‚   â”œâ”€â”€ excel/             # Excel æ–‡ä»¶
â”‚   â””â”€â”€ edited/            # ç¼–è¾‘æ•°æ®
â”œâ”€â”€ logs/                   # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ app.log            # åº”ç”¨æ—¥å¿—
â”‚   â”œâ”€â”€ error.log          # é”™è¯¯æ—¥å¿—
â”‚   â””â”€â”€ access.log         # è®¿é—®æ—¥å¿—
â”œâ”€â”€ venv/                   # Python è™šæ‹Ÿç¯å¢ƒ
â””â”€â”€ db.sqlite3             # SQLite æ•°æ®åº“
```

---

## ğŸ”§ æœåŠ¡ç®¡ç†

### å¯åŠ¨æœåŠ¡

#### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd /home/lenovo/development_project/ocrpngtoexcel_test
source venv/bin/activate
cd backend
python -m app.main
```

æˆ–ä½¿ç”¨ nohup åå°è¿è¡Œï¼š

```bash
cd /home/lenovo/development_project/ocrpngtoexcel_test
source venv/bin/activate
cd backend
nohup python -m app.main > ../logs/backend.log 2>&1 &
```

#### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd /home/lenovo/development_project/ocrpngtoexcel_test/frontend
npm start
```

æˆ–ä½¿ç”¨åå°è¿è¡Œï¼š

```bash
cd /home/lenovo/development_project/ocrpngtoexcel_test/frontend
nohup npm start > ../logs/frontend.log 2>&1 &
```

#### 3. ç¡®è®¤ OCR æœåŠ¡

OCR æœåŠ¡åº”è¯¥å·²åœ¨ç«¯å£ 8088 è¿è¡Œï¼š

```bash
curl http://localhost:8088/health
```

### åœæ­¢æœåŠ¡

#### åœæ­¢åç«¯

```bash
# æŸ¥æ‰¾è¿›ç¨‹
ps aux | grep "python -m app.main"

# åœæ­¢è¿›ç¨‹
kill -9 <PID>
```

#### åœæ­¢å‰ç«¯

```bash
# æŸ¥æ‰¾è¿›ç¨‹
ps aux | grep "node.*react-scripts"

# åœæ­¢è¿›ç¨‹
kill -9 <PID>
```

### é‡å¯æœåŠ¡

```bash
# åœæ­¢æœåŠ¡
./stop.sh

# ç­‰å¾… 5 ç§’
sleep 5

# å¯åŠ¨æœåŠ¡
./start.sh
```

### æœåŠ¡çŠ¶æ€æ£€æŸ¥

#### æ£€æŸ¥åç«¯çŠ¶æ€

```bash
curl http://localhost:8000/health
```

**æ­£å¸¸å“åº”**:
```json
{
  "status": "healthy",
  "database": "connected",
  "ocr_service": "connected",
  "data_directories": {
    "images": {"exists": true},
    "ocr_json": {"exists": true},
    "excel": {"exists": true},
    "temp": {"exists": true}
  }
}
```

#### æ£€æŸ¥å‰ç«¯çŠ¶æ€

```bash
curl -I http://localhost:3000
```

**æ­£å¸¸å“åº”**: HTTP/1.1 200 OK

#### æ£€æŸ¥ OCR æœåŠ¡

```bash
curl http://localhost:8088/health
```

### è‡ªåŠ¨å¯åŠ¨é…ç½®

#### åˆ›å»º systemd æœåŠ¡ï¼ˆæ¨èï¼‰

**åç«¯æœåŠ¡**: `/etc/systemd/system/ocrpngtoexcel-backend.service`

```ini
[Unit]
Description=OCR PNG to Excel Backend Service
After=network.target

[Service]
Type=simple
User=lenovo
WorkingDirectory=/home/lenovo/development_project/ocrpngtoexcel_test/backend
Environment="PATH=/home/lenovo/development_project/ocrpngtoexcel_test/venv/bin"
ExecStart=/home/lenovo/development_project/ocrpngtoexcel_test/venv/bin/python -m app.main
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

**å¯ç”¨æœåŠ¡**:

```bash
sudo systemctl daemon-reload
sudo systemctl enable ocrpngtoexcel-backend
sudo systemctl start ocrpngtoexcel-backend
sudo systemctl status ocrpngtoexcel-backend
```

---

## ğŸ“Š æ—¥å¸¸è¿ç»´

### æ—¥å¿—ç®¡ç†

#### æ—¥å¿—æ–‡ä»¶ä½ç½®

```
logs/
â”œâ”€â”€ app.log       # åº”ç”¨æ—¥å¿—ï¼ˆæ‰€æœ‰çº§åˆ«ï¼‰
â”œâ”€â”€ error.log     # é”™è¯¯æ—¥å¿—ï¼ˆERROR åŠä»¥ä¸Šï¼‰
â””â”€â”€ access.log    # HTTP è®¿é—®æ—¥å¿—
```

#### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f logs/access.log

# æœç´¢ç‰¹å®šé”™è¯¯
grep -i "error" logs/app.log

# ç»Ÿè®¡é”™è¯¯æ•°é‡
grep -c "ERROR" logs/app.log
```

#### æ—¥å¿—è½®è½¬

ç³»ç»Ÿå·²é…ç½®è‡ªåŠ¨æ—¥å¿—è½®è½¬ï¼š

- **app.log / error.log**: è¾¾åˆ° 10MB æ—¶è½®è½¬ï¼Œä¿ç•™ 5 ä¸ªå¤‡ä»½
- **access.log**: æ¯å¤©åˆå¤œè½®è½¬ï¼Œä¿ç•™ 30 å¤©

#### æ¸…ç†æ—¥å¿—

```bash
# æ¸…ç† 30 å¤©å‰çš„æ—¥å¿—
find logs/ -name "*.log.*" -mtime +30 -delete

# æ¸…ç©ºå½“å‰æ—¥å¿—ï¼ˆä¸æ¨èï¼‰
> logs/app.log
> logs/error.log
```

### æ•°æ®ç®¡ç†

#### æ•°æ®ç›®å½•

```
data/
â”œâ”€â”€ images/      # ä¸Šä¼ çš„å›¾ç‰‡
â”œâ”€â”€ ocr_json/    # OCR è¯†åˆ«ç»“æœ
â”œâ”€â”€ excel/       # ç”Ÿæˆçš„ Excel æ–‡ä»¶
â””â”€â”€ edited/      # ç¼–è¾‘åçš„æ•°æ®
```

#### æ¸…ç†ä¸´æ—¶æ–‡ä»¶

```bash
# æ¸…ç† 7 å¤©å‰çš„å›¾ç‰‡
find data/images/ -name "*.png" -mtime +7 -delete
find data/images/ -name "*.jpg" -mtime +7 -delete

# æ¸…ç† 7 å¤©å‰çš„ JSON
find data/ocr_json/ -name "*.json" -mtime +7 -delete

# æ¸…ç† 7 å¤©å‰çš„ Excel
find data/excel/ -name "*.xlsx" -mtime +7 -delete
```

#### ç£ç›˜ç©ºé—´ç›‘æ§

```bash
# æ£€æŸ¥æ•°æ®ç›®å½•å ç”¨
du -sh data/*

# æ£€æŸ¥æ€»ç£ç›˜ä½¿ç”¨
df -h

# æ‰¾å‡ºå¤§æ–‡ä»¶
find data/ -type f -size +10M -exec ls -lh {} \;
```

### æ•°æ®åº“ç®¡ç†

#### æŸ¥çœ‹æ•°æ®åº“

```bash
cd /home/lenovo/development_project/ocrpngtoexcel_test
sqlite3 db.sqlite3

# SQLite å‘½ä»¤
.tables                    # æŸ¥çœ‹æ‰€æœ‰è¡¨
.schema task              # æŸ¥çœ‹è¡¨ç»“æ„
SELECT COUNT(*) FROM task; # æŸ¥è¯¢ä»»åŠ¡æ•°é‡
.quit                     # é€€å‡º
```

#### æ¸…ç†æ—§æ•°æ®

```sql
-- åˆ é™¤ 30 å¤©å‰çš„ä»»åŠ¡
DELETE FROM task 
WHERE created_at < datetime('now', '-30 days');

-- æ¸…ç©ºæ‰€æœ‰ä»»åŠ¡ï¼ˆå±é™©æ“ä½œï¼‰
DELETE FROM task;

-- é‡ç½®è‡ªå¢ ID
DELETE FROM sqlite_sequence WHERE name='task';

-- çœŸç©ºæ•°æ®åº“ï¼ˆå›æ”¶ç©ºé—´ï¼‰
VACUUM;
```

### ç³»ç»Ÿèµ„æºç›‘æ§

#### CPU å’Œå†…å­˜

```bash
# æŸ¥çœ‹è¿›ç¨‹èµ„æºå ç”¨
ps aux | grep python
ps aux | grep node

# å®æ—¶ç›‘æ§
top -p $(pgrep -f "python -m app.main")
```

#### ç½‘ç»œç›‘æ§

```bash
# æŸ¥çœ‹ç«¯å£è¿æ¥æ•°
netstat -an | grep :8000 | wc -l
netstat -an | grep :3000 | wc -l

# æŸ¥çœ‹è¿æ¥è¯¦æƒ…
netstat -antp | grep :8000
```

---

## ğŸ” ç›‘æ§å‘Šè­¦

### å¥åº·æ£€æŸ¥è„šæœ¬

åˆ›å»º `scripts/health_check.sh`:

```bash
#!/bin/bash

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

echo "=== OCR PNG to Excel å¥åº·æ£€æŸ¥ ==="
echo ""

# æ£€æŸ¥åç«¯
echo -n "åç«¯æœåŠ¡ (8000): "
if curl -s http://localhost:8000/health > /dev/null; then
    echo -e "${GREEN}âœ“ æ­£å¸¸${NC}"
else
    echo -e "${RED}âœ— å¼‚å¸¸${NC}"
fi

# æ£€æŸ¥å‰ç«¯
echo -n "å‰ç«¯æœåŠ¡ (3000): "
if curl -s -o /dev/null -w "%{http_code}" http://localhost:3000 | grep -q "200"; then
    echo -e "${GREEN}âœ“ æ­£å¸¸${NC}"
else
    echo -e "${RED}âœ— å¼‚å¸¸${NC}"
fi

# æ£€æŸ¥ OCR
echo -n "OCR æœåŠ¡ (8088): "
if curl -s http://localhost:8088/health > /dev/null; then
    echo -e "${GREEN}âœ“ æ­£å¸¸${NC}"
else
    echo -e "${RED}âœ— å¼‚å¸¸${NC}"
fi

# æ£€æŸ¥ç£ç›˜ç©ºé—´
echo ""
echo "=== ç£ç›˜ç©ºé—´ ==="
df -h | grep -E '^/dev/'

# æ£€æŸ¥æ•°æ®ç›®å½•å¤§å°
echo ""
echo "=== æ•°æ®ç›®å½•å¤§å° ==="
du -sh data/*

echo ""
echo "=== æ£€æŸ¥å®Œæˆ ==="
```

è¿è¡Œ:

```bash
chmod +x scripts/health_check.sh
./scripts/health_check.sh
```

### å®šæ—¶ç›‘æ§ï¼ˆCrontabï¼‰

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹ä»»åŠ¡
# æ¯ 5 åˆ†é’Ÿæ£€æŸ¥æœåŠ¡çŠ¶æ€
*/5 * * * * /home/lenovo/development_project/ocrpngtoexcel_test/scripts/health_check.sh >> /var/log/ocrpngtoexcel_health.log 2>&1

# æ¯å¤©å‡Œæ™¨ 2 ç‚¹æ¸…ç†æ—§æ–‡ä»¶
0 2 * * * find /home/lenovo/development_project/ocrpngtoexcel_test/data/images/ -mtime +7 -delete
0 2 * * * find /home/lenovo/development_project/ocrpngtoexcel_test/data/excel/ -mtime +7 -delete
```

### ç›‘æ§æŒ‡æ ‡

è®¿é—®: `http://localhost:8000/api/v1/tasks/metrics/summary`

è¿”å›ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼š
- æ“ä½œæ¬¡æ•°
- æˆåŠŸ/å¤±è´¥æ¬¡æ•°
- å¹³å‡å“åº”æ—¶é—´
- é”™è¯¯ç‡

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. åç«¯æœåŠ¡æ— æ³•å¯åŠ¨

**ç—‡çŠ¶**: `Address already in use`

**åŸå› **: ç«¯å£ 8000 å·²è¢«å ç”¨

**è§£å†³**:
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :8000

# åœæ­¢è¿›ç¨‹
kill -9 <PID>

# é‡æ–°å¯åŠ¨
python -m app.main
```

#### 2. å‰ç«¯æ— æ³•è®¿é—®

**ç—‡çŠ¶**: `ERR_CONNECTION_REFUSED`

**æ£€æŸ¥**:
```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
netstat -tuln | grep :3000

# æ£€æŸ¥è¿›ç¨‹
ps aux | grep node
```

**è§£å†³**:
```bash
cd frontend
npm start
```

#### 3. OCR è¯†åˆ«å¤±è´¥

**ç—‡çŠ¶**: "OCR ä»»åŠ¡åˆ›å»ºå¤±è´¥"

**æ£€æŸ¥**:
```bash
# æ£€æŸ¥ OCR æœåŠ¡
curl http://localhost:8088/health
```

**è§£å†³**:
- æ£€æŸ¥ OCR æœåŠ¡æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹åç«¯æ—¥å¿—: `tail -f logs/error.log`

#### 4. æ•°æ®åº“é”™è¯¯

**ç—‡çŠ¶**: "Database connection failed"

**æ£€æŸ¥**:
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
ls -lh db.sqlite3

# æ£€æŸ¥æ–‡ä»¶æƒé™
chmod 644 db.sqlite3
```

#### 5. ç£ç›˜ç©ºé—´ä¸è¶³

**ç—‡çŠ¶**: "No space left on device"

**æ£€æŸ¥**:
```bash
df -h
du -sh data/*
```

**è§£å†³**:
```bash
# æ¸…ç†æ—§æ–‡ä»¶
find data/images/ -mtime +7 -delete
find data/excel/ -mtime +7 -delete
```

### æ—¥å¿—åˆ†æ

#### æŸ¥æ‰¾é”™è¯¯

```bash
# æŸ¥æ‰¾æœ€è¿‘çš„é”™è¯¯
tail -100 logs/error.log

# æŒ‰æ—¶é—´æŸ¥æ‰¾
grep "2026-01-16" logs/error.log

# ç»Ÿè®¡é”™è¯¯ç±»å‹
grep "ERROR" logs/app.log | awk '{print $NF}' | sort | uniq -c
```

#### æ€§èƒ½é—®é¢˜

```bash
# æŸ¥æ‰¾æ…¢è¯·æ±‚ï¼ˆå“åº”æ—¶é—´ > 1000msï¼‰
grep "Time:" logs/app.log | awk -F'Time: ' '{print $2}' | awk -F'ms' '{if($1>1000) print}'
```

---

## ğŸ’¾ å¤‡ä»½æ¢å¤

### å¤‡ä»½ç­–ç•¥

#### æ•°æ®å¤‡ä»½

```bash
#!/bin/bash
# backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/ocrpngtoexcel"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
cp db.sqlite3 $BACKUP_DIR/db_$DATE.sqlite3

# å¤‡ä»½æ•°æ®æ–‡ä»¶
tar -czf $BACKUP_DIR/data_$DATE.tar.gz data/

# åˆ é™¤ 7 å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.sqlite3" -mtime +7 -delete
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: $DATE"
```

#### å®šæ—¶å¤‡ä»½

```bash
# æ¯å¤©å‡Œæ™¨ 3 ç‚¹å¤‡ä»½
0 3 * * * /home/lenovo/development_project/ocrpngtoexcel_test/scripts/backup.sh >> /var/log/backup.log 2>&1
```

### æ¢å¤æ•°æ®

```bash
# æ¢å¤æ•°æ®åº“
cp /backup/ocrpngtoexcel/db_20260116_030000.sqlite3 db.sqlite3

# æ¢å¤æ•°æ®æ–‡ä»¶
tar -xzf /backup/ocrpngtoexcel/data_20260116_030000.tar.gz
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿä¼˜åŒ–

1. **è°ƒæ•´æ–‡ä»¶æè¿°ç¬¦é™åˆ¶**

```bash
# ç¼–è¾‘ /etc/security/limits.conf
* soft nofile 65535
* hard nofile 65535
```

2. **è°ƒæ•´ TCP å‚æ•°**

```bash
# ç¼–è¾‘ /etc/sysctl.conf
net.core.somaxconn = 2048
net.ipv4.tcp_max_syn_backlog = 2048
```

### åº”ç”¨ä¼˜åŒ–

1. **å¯ç”¨ç”Ÿäº§æ¨¡å¼**

```bash
# backend/.env
DEBUG=false
```

2. **ä½¿ç”¨ Gunicornï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**

```bash
pip install gunicorn
gunicorn -w 4 -k uvicorn.workers.UvicornWorker app.main:app --bind 0.0.0.0:8000
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2026-01-16
