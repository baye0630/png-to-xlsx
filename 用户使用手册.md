# OCR PNG to Excel - 用户使用手册

**版本**: 1.0.0  
**更新日期**: 2026-01-16

---

## 📋 目录

- [系统简介](#系统简介)
- [访问地址](#访问地址)
- [主要功能](#主要功能)
- [快速开始](#快速开始)
- [详细操作指南](#详细操作指南)
- [常见问题](#常见问题)
- [注意事项](#注意事项)
- [技术支持](#技术支持)

---

## 🎯 系统简介

**OCR PNG to Excel** 是一款智能图片表格识别系统，能够将图片中的表格自动识别并转换为可编辑的 Excel 文件。

### 核心特点

- ✅ **智能识别** - 基于 PaddleOCR 引擎，识别准确率高
- ✅ **在线编辑** - 识别后可在线编辑修改表格内容
- ✅ **多表格支持** - 自动识别图片中的多个表格，分别生成多个 Sheet
- ✅ **格式保留** - 保留表格的合并单元格、表头等格式
- ✅ **一键下载** - 编辑完成后一键下载为 Excel 文件

### 适用场景

- 📊 扫描文档中的表格数据提取
- 📸 手机拍摄的表格图片转换
- 📄 PDF 截图中的表格识别
- 📋 报表、账单等表格数据录入

---

## 🌐 访问地址

### 生产环境

```
http://10.119.133.236:3000
```

### 本地开发环境

```
前端界面: http://localhost:3000
后端 API: http://localhost:8000
健康检查: http://localhost:8000/health
```

### 推荐浏览器

- ✅ Chrome / Edge (推荐，版本 90+)
- ✅ Firefox (版本 88+)
- ✅ Safari (版本 14+)

> **注意**: 为获得最佳体验，请使用最新版本的 Chrome 浏览器。

---

## ✨ 主要功能

### 1. 图片上传

支持多种方式上传图片：
- 拖拽上传
- 点击选择文件
- 支持的格式：PNG、JPG、JPEG、GIF、BMP、WebP

### 2. 自动 OCR 识别

- 自动识别图片中的表格
- 支持复杂表格结构（合并单元格、多层表头）
- 自动分离多个表格

### 3. 在线预览与编辑

- 实时预览识别结果
- 双击单元格即可编辑
- 支持多 Sheet 切换
- 保留表格格式

### 4. Excel 导出

- 保存编辑后的数据
- 一键下载为 Excel 文件
- 保留合并单元格和表头格式

---

## 🚀 快速开始

### 第一步：打开系统

在浏览器中输入访问地址：
```
http://10.119.133.236:3000
```

### 第二步：上传图片

**方式一：拖拽上传**
1. 将图片文件拖拽到上传区域
2. 松开鼠标即可

**方式二：选择文件**
1. 点击"选择文件"按钮
2. 在弹出的文件选择器中选择图片
3. 点击"打开"

### 第三步：等待识别

1. 点击"开始识别"按钮
2. 系统自动上传并处理图片
3. 等待 OCR 识别完成（通常 10-30 秒）
4. 识别完成后自动显示结果

### 第四步：编辑表格

1. 在右侧表格区域查看识别结果
2. 双击单元格进行编辑
3. 按 Enter 保存，按 Esc 取消
4. 如有多个表格，可切换 Sheet 标签页

### 第五步：下载 Excel

1. 确认所有修改完成
2. 点击"保存修改"按钮（如有修改）
3. 点击"下载 Excel"按钮
4. Excel 文件自动下载到本地

---

## 📖 详细操作指南

### 一、图片上传详细说明

#### 1.1 支持的图片格式

| 格式 | 扩展名 | 推荐 |
|------|--------|------|
| PNG | .png | ✅ 推荐 |
| JPEG | .jpg, .jpeg | ✅ 推荐 |
| GIF | .gif | ⚠️ 支持 |
| BMP | .bmp | ⚠️ 支持 |
| WebP | .webp | ⚠️ 支持 |

#### 1.2 图片要求

**推荐的图片特征**:
- ✅ 清晰度高，文字清晰可读
- ✅ 光线充足，无阴影遮挡
- ✅ 拍摄角度正，无严重倾斜
- ✅ 表格边框清晰
- ✅ 文件大小 < 10MB

**不推荐**:
- ❌ 模糊、失焦的图片
- ❌ 严重倾斜或变形的图片
- ❌ 光线不足或过曝的图片
- ❌ 表格边框不清晰

#### 1.3 上传步骤

**拖拽上传**:
```
1. 找到要上传的图片文件
2. 用鼠标拖拽文件到上传区域（灰色虚线框）
3. 看到上传区域高亮时松开鼠标
4. 系统自动显示文件信息
```

**选择上传**:
```
1. 点击"选择文件"按钮
2. 在文件选择器中浏览并选择图片
3. 点击"打开"按钮
4. 系统自动显示文件信息
```

### 二、OCR 识别流程

#### 2.1 开始识别

点击"开始识别"按钮后，系统会：

```
1. 上传图片 (2-5 秒)
   └─ 显示: "正在上传图片..."

2. 启动 OCR (1-2 秒)
   └─ 显示: "正在启动 OCR 识别..."

3. OCR 处理中 (10-30 秒)
   └─ 显示: "OCR 处理中，请稍候..."
   └─ 进度提示: "OCR 处理中... (1/30)"

4. 识别完成
   └─ 显示: "OCR 识别完成！"
   └─ 自动切换到表格预览界面
```

#### 2.2 识别状态说明

| 状态 | 图标 | 说明 |
|------|------|------|
| 上传中 | ⏳ | 正在上传图片到服务器 |
| OCR 启动中 | 🔄 | 正在启动 OCR 识别引擎 |
| OCR 处理中 | 🔍 | 正在识别图片中的表格 |
| 识别成功 | ✅ | 识别完成，可以查看结果 |
| 识别失败 | ❌ | 识别失败，请重试 |

#### 2.3 识别时间

识别时间取决于：
- 图片大小（文件越大，识别越慢）
- 图片分辨率（分辨率越高，识别越慢）
- 表格复杂度（表格越复杂，识别越慢）

**参考时间**:
- 简单表格（< 1MB）: 10-15 秒
- 普通表格（1-3MB）: 15-25 秒
- 复杂表格（3-10MB）: 25-40 秒

### 三、表格编辑功能

#### 3.1 表格预览

识别完成后，右侧会显示表格预览：

```
┌─────────────────────────────────────┐
│  Sheet 1  │  Sheet 2  │  Sheet 3   │  ← Sheet 标签页
├─────────────────────────────────────┤
│                                     │
│   ┌──────┬──────┬──────┬──────┐   │
│   │ 姓名 │ 年龄 │ 性别 │ 职位 │   │  ← 表格内容
│   ├──────┼──────┼──────┼──────┤   │
│   │ 张三 │  28  │  男  │ 经理 │   │
│   ├──────┼──────┼──────┼──────┤   │
│   │ 李四 │  25  │  女  │ 员工 │   │
│   └──────┴──────┴──────┴──────┘   │
│                                     │
└─────────────────────────────────────┘
```

#### 3.2 切换 Sheet

如果图片中有多个表格，系统会自动分离为多个 Sheet：

```
1. 点击顶部的 Sheet 标签页
2. 查看不同表格的内容
3. 每个 Sheet 独立编辑
```

#### 3.3 编辑单元格

**开始编辑**:
```
1. 双击要编辑的单元格
2. 单元格变为蓝色边框，出现输入框
3. 输入新的内容
```

**保存编辑**:
```
方式一: 按 Enter 键
方式二: 点击单元格外部区域
```

**取消编辑**:
```
按 Esc 键 - 恢复原来的内容
```

**编辑提示**:
- 💡 双击单元格可编辑
- 💡 Enter 保存，Esc 取消
- 💡 编辑后按钮会显示 "*" 标记

#### 3.4 编辑状态

| 状态 | 显示 | 说明 |
|------|------|------|
| 未修改 | "保存修改" (灰色) | 没有修改内容 |
| 已修改 | "保存修改 *" (绿色) | 有未保存的修改 |
| 保存中 | "保存中..." (灰色) | 正在保存数据 |

### 四、保存与下载

#### 4.1 保存修改

如果您编辑了表格内容：

```
1. 点击"保存修改 *"按钮（绿色）
2. 等待保存完成（通常 1-2 秒）
3. 看到"保存成功！Excel 已更新"提示
4. 按钮恢复为"保存修改"（灰色）
```

> **重要**: 保存后会重新生成 Excel 文件，确保下载的内容与编辑一致。

#### 4.2 下载 Excel

```
1. 点击"下载 Excel"按钮
2. 浏览器自动下载文件
3. 文件名格式: 图片名称_修改时间.xlsx
4. 下载完成后可用 Excel/WPS 打开
```

#### 4.3 Excel 文件说明

下载的 Excel 文件特点：
- ✅ 包含所有识别的表格（多个 Sheet）
- ✅ 保留合并单元格格式
- ✅ 保留表头样式（加粗、灰色背景）
- ✅ 自动调整列宽
- ✅ 包含所有编辑后的内容

### 五、重新上传

如果想识别新的图片：

```
1. 点击"重新上传"按钮
2. 清除当前内容
3. 返回上传界面
4. 重复上传流程
```

---

## ❓ 常见问题

### Q1: 上传后提示"上传失败"怎么办？

**可能原因**:
- 文件格式不支持
- 文件大小超过限制（> 10MB）
- 网络连接问题

**解决方法**:
1. 检查文件格式是否为图片
2. 检查文件大小是否过大
3. 压缩图片后重试
4. 检查网络连接

### Q2: OCR 识别失败怎么办？

**可能原因**:
- 图片模糊不清
- 表格边框不明显
- 拍摄角度倾斜严重
- OCR 服务繁忙

**解决方法**:
1. 使用更清晰的图片重试
2. 确保表格边框清晰
3. 调整拍摄角度，尽量垂直拍摄
4. 等待几分钟后重试

### Q3: OCR 识别超时怎么办？

**原因**: 图片太大或太复杂，处理时间超过限制

**解决方法**:
1. 压缩图片分辨率
2. 裁剪图片，只保留表格部分
3. 分多次识别（如果有多个表格）

### Q4: 识别结果不准确怎么办？

**原因**: OCR 技术本身的限制

**解决方法**:
1. 使用在线编辑功能修改错误内容
2. 双击单元格直接编辑
3. 修改完成后保存并下载

### Q5: 为什么有的单元格是空的？

**原因**: 
- 图片中该单元格本身为空
- OCR 未能识别出内容
- 内容太模糊

**解决方法**:
1. 检查原图是否有内容
2. 手动编辑补充内容
3. 使用更清晰的图片重新识别

### Q6: 下载的 Excel 文件打不开？

**可能原因**:
- 浏览器下载不完整
- 文件损坏

**解决方法**:
1. 重新下载
2. 清除浏览器缓存后重试
3. 更换浏览器尝试

### Q7: 编辑后忘记保存直接下载了怎么办？

**结果**: 下载的 Excel 不包含最新修改

**解决方法**:
1. 重新进行编辑
2. 点击"保存修改"按钮
3. 确认保存成功后再下载

### Q8: 可以一次上传多张图片吗？

**回答**: 目前不支持批量上传

**建议**:
- 每次上传一张图片
- 处理完成后点击"重新上传"上传下一张

### Q9: 识别后的表格格式混乱怎么办？

**原因**: 
- 原图表格结构复杂
- 合并单元格较多
- OCR 识别偏差

**解决方法**:
1. 使用在线编辑功能调整
2. 下载后用 Excel 手动调整
3. 使用结构更简单的图片重试

### Q10: 系统支持手写表格吗？

**回答**: 支持，但准确率会降低

**建议**:
- 手写内容尽量清晰工整
- 表格线条清晰
- 识别后仔细检查并编辑

---

## ⚠️ 注意事项

### 图片质量要求

1. **清晰度**
   - ✅ 推荐: 高清扫描或拍摄，文字清晰可读
   - ❌ 避免: 模糊、失焦的图片

2. **光线**
   - ✅ 推荐: 光线均匀，无阴影
   - ❌ 避免: 过暗、过亮、有反光

3. **角度**
   - ✅ 推荐: 垂直拍摄，无倾斜
   - ❌ 避免: 斜角拍摄、严重变形

4. **背景**
   - ✅ 推荐: 纯色背景，表格与背景对比明显
   - ❌ 避免: 杂乱背景、表格与背景颜色接近

### 数据安全

1. **数据存储**
   - 上传的图片和识别结果会临时存储在服务器
   - 建议及时下载并删除任务

2. **敏感信息**
   - 如涉及敏感信息，请谨慎使用
   - 下载后建议删除服务器数据

### 使用限制

1. **文件大小**: 单个图片不超过 10MB
2. **并发处理**: 建议同时处理的任务不超过 5 个
3. **识别时间**: 单个任务最长等待时间 60 秒

### 最佳实践

1. **图片准备**
   - 使用扫描仪扫描，效果最佳
   - 手机拍摄时开启网格线，保持垂直
   - 裁剪掉无关内容，只保留表格

2. **识别后检查**
   - 仔细核对识别结果
   - 重点检查数字、特殊符号
   - 检查合并单元格是否正确

3. **编辑技巧**
   - 先按 Sheet 整体检查
   - 逐行检查内容准确性
   - 及时保存修改

4. **文件管理**
   - 下载的 Excel 文件及时重命名
   - 建立文件分类存储
   - 定期备份重要数据

---

## 🔧 技术支持

### 系统状态检查

访问以下地址检查系统运行状态：
```
http://10.119.133.236:8000/health
```

**正常响应**:
```json
{
  "status": "healthy",
  "database": "connected",
  "ocr_service": "connected"
}
```

### 常见错误代码

| 错误代码 | 含义 | 解决方法 |
|----------|------|----------|
| 400 | 请求参数错误 | 检查上传的文件 |
| 404 | 任务不存在 | 重新上传图片 |
| 500 | 服务器错误 | 联系技术支持 |
| 503 | 服务暂时不可用 | 稍后重试 |

### 获取帮助

如遇到问题，请联系技术支持：

**邮箱**: support@example.com  
**电话**: 400-xxx-xxxx  
**工作时间**: 周一至周五 9:00-18:00

提供问题时，请说明：
1. 操作步骤
2. 错误截图
3. 浏览器类型和版本
4. 图片特征（大小、格式等）

---

## 📚 附录

### A. 快捷键

| 快捷键 | 功能 |
|--------|------|
| 双击单元格 | 开始编辑 |
| Enter | 保存编辑 |
| Esc | 取消编辑 |

### B. 浏览器兼容性

| 浏览器 | 版本要求 | 推荐 |
|--------|----------|------|
| Chrome | 90+ | ⭐⭐⭐⭐⭐ |
| Edge | 90+ | ⭐⭐⭐⭐⭐ |
| Firefox | 88+ | ⭐⭐⭐⭐ |
| Safari | 14+ | ⭐⭐⭐⭐ |

### C. 支持的表格类型

✅ 支持:
- 简单表格（行列清晰）
- 复杂表格（合并单元格）
- 多表格（同一张图片多个表格）
- 嵌套表头
- 跨行跨列单元格

⚠️ 部分支持:
- 手写表格（准确率较低）
- 无边框表格（需要对齐清晰）

❌ 不支持:
- 非表格内容（纯文字）
- 图表、图片
- 公式

### D. 更新日志

**v1.0.0** (2026-01-16)
- ✅ 首次发布
- ✅ 支持图片上传
- ✅ 支持 OCR 识别
- ✅ 支持在线编辑
- ✅ 支持 Excel 下载
- ✅ 支持多 Sheet

---

## 📄 版权信息

**版权所有** © 2026 OCR PNG to Excel  
**保留所有权利**

本手册内容受版权保护，未经授权不得复制、传播或用于商业用途。

---

**感谢使用 OCR PNG to Excel！**

如有任何建议或意见，欢迎反馈。我们将持续改进系统，为您提供更好的服务。

---

*最后更新: 2026-01-16*
